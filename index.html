<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: white;
            color: white;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        #startScreen, #gameContainer {
            width: 80vw;
            height: 80vh;
        }

        #startScreen {
            display: flex;
            flex-direction: column;
        }

        #gameContainer {
            display: none;
        }

        h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 6vw;
            text-align: center;
            margin-bottom: 20px;
            margin-top: 50%;
        }

        button {
            padding: 5vw 10vw;
            font-size: 3vw;
            cursor: pointer;
            margin-top: 5vw;
            background-color: white;
            color: black;
            font-family: 'Press Start 2P', cursive;
        }

        .invaders-row {
            display: flex;
            justify-content: center;
            margin-top: 8vw;
        }

        .invader {
            width: 7vw; /* Tamanho ajustado dos invasores */
            height: 7vw; /* Tamanho ajustado dos invasores */
            margin: 1vw;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center center;
        }

        .footer {
            position: absolute;
            bottom: 4vw;
            font-size: 4vw;
            text-align: center;
            width: 100%;
        }

        canvas {
            width: 90vw;
            height: 60vh;
        }
        div.footer{
            color: white;
            font-family: 'Press Start 2P', cursive;
            text-align: left;
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <h1>SPACE ALIEN INVADERS</h1>
        <div class="invaders-row">
            <div class="invader"></div>
            <div class="invader"></div>
            <div class="invader"></div>
            <div class="invader"></div>
        </div>
        <button id="playButton">ENTRAR</button>
        <div class="footer">SENAI</div>
    </div>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
    </div>
    <script>
        const startScreen = document.getElementById('startScreen');
        const gameContainer = document.getElementById('gameContainer');
        const playButton = document.getElementById('playButton');
        const canvas = document.getElementById('gameCanvas');
        const context = canvas.getContext('2d');
        let spaceshipTouchStartX = null;
        canvas.width = window.innerWidth * 0.9;
        canvas.height = window.innerHeight * 0.6;

        playButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            gameContainer.style.display = 'flex';
            startGame();
        });

        const spaceshipImage = new Image();
        spaceshipImage.src = 'https://static.vecteezy.com/system/resources/previews/016/778/825/non_2x/spaceship-alien-galaxy-fleet-free-png.png';

        const invaderImage = new Image();
        invaderImage.src = 'pngtree-space.png';

        const spaceship = {
            x: canvas.width / 2 - 25,
            y: canvas.height - 60,
            width: 50,
            height: 50,
            dx: 5,
            lives: 3
        };

        const bullets = [];
        const invaderBullets = [];
        const invaders = [];
        const invaderRows = 3;
        const invaderCols = 4;
        let invaderWidth = 7 * (canvas.width / 80); // Tamanho ajustado dos invasores
        let invaderHeight = 7 * (canvas.width / 80); // Tamanho ajustado dos invasores
        const invaderPadding = 1.5 * (canvas.width / 80); // Ajuste o espaÃ§amento entre os invasores
        let invaderOffsetTop = 20 * (canvas.width / 800); // Ajuste o offset superior
        let invaderOffsetLeft = (canvas.width - (invaderCols * (invaderWidth + invaderPadding))) / 2;

        function drawSpaceship() {
            context.drawImage(spaceshipImage, spaceship.x, spaceship.y, spaceship.width, spaceship.height);
        }

        function drawBullets() {
            bullets.forEach(bullet => {
                context.fillStyle = 'red';
                context.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                bullet.y -= bullet.dy;
            });

            bullets.forEach((bullet, index) => {
                if (bullet.y < 0) {
                    bullets.splice(index, 1);
                }
            });
        }

        function drawInvaderBullets() {
            invaderBullets.forEach(bullet => {
                context.fillStyle = 'yellow';
                context.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                bullet.y += bullet.dy;
            });

            invaderBullets.forEach((bullet, index) => {
                if (bullet.y > canvas.height) {
                    invaderBullets.splice(index, 1);
                }
            });
        }

        function createInvaders() {
            for (let r = 0; r < invaderRows; r++) {
                invaders[r] = [];
                for (let c = 0; c < invaderCols; c++) {
                    let invaderX = c * (invaderWidth + invaderPadding) + invaderOffsetLeft;
                    let invaderY = r * (invaderHeight + invaderPadding) + invaderOffsetTop;
                    invaders[r][c] = { x: invaderX, y: invaderY, width: invaderWidth, height: invaderHeight, status: 1, canShoot: true };
                }
            }
        }

        function drawInvaders() {
            for (let r = 0; r < invaderRows; r++) {
                for (let c = 0; c < invaderCols; c++) {
                    if (invaders[r][c].status === 1) {
                        context.drawImage(invaderImage, invaders[r][c].x, invaders[r][c].y, invaders[r][c].width, invaders[r][c].height);
                    }
                }
            }
        }

        function moveSpaceship() {
            if (rightPressed && spaceship.x < canvas.width - spaceship.width) {
                spaceship.x += spaceship.dx;
            } else if (leftPressed && spaceship.x > 0) {
                spaceship.x -= spaceship.dx;
            }
        }

        function shootBullet() {
            if (bullets.length < 3) {
                bullets.push({
                    x: spaceship.x + spaceship.width / 2 - 2.5,
                    y: spaceship.y,
                    width: 5,
                    height: 10,
                    dy: 7
                });
            }
        }

        function invaderShootBullet() {
            invaders.forEach(row => {
                row.forEach(invader => {
                    if (invader.status === 1 && invader.canShoot && Math.random() < 0.005) {
                        invaderBullets.push({
                            x: invader.x + invader.width / 2 - 2.5,
                            y: invader.y + invader.height,
                            width: 5,
                            height: 10,
                            dy: 3
                        });
                        invader.canShoot = false;
                    }
                });
            });
        }

        function resetInvaderShooting() {
            invaders.forEach(row => {
                row.forEach(invader => {
                    invader.canShoot = true;
                });
            });
        }

        function collisionDetection() {
            bullets.forEach(bullet => {
                for (let r = 0; r < invaderRows; r++) {
                    for (let c = 0; c < invaderCols; c++) {
                        let invader = invaders[r][c];
                        if (invader.status === 1) {
                            if (bullet.x > invader.x && bullet.x < invader.x + invader.width && bullet.y > invader.y && bullet.y < invader.y + invader.height) {
                                invader.status = 0;
                                bullet.y = -10;
                            }
                        }
                    }
                }
            });

            invaderBullets.forEach((bullet, index) => {
                if (bullet.x > spaceship.x && bullet.x < spaceship.x + spaceship.width && bullet.y > spaceship.y && bullet.y < spaceship.y + spaceship.height) {
                    spaceship.lives--;
                    invaderBullets.splice(index, 1);
                    if (spaceship.lives <= 0) {
                        alert('Game Over');
                        document.location.reload();
                    }
                }
            });
        }

        function drawLives() {
            context.fillStyle = 'white';
            context.font = `${canvas.width * 0.03}px Arial`;
            context.fillText(`Lives: ${spaceship.lives}`, canvas.width - (canvas.width * 0.1), canvas.width * 0.02);
        }

        function draw() {
            context.clearRect(0, 0, canvas.width, canvas.height);
            drawSpaceship();
            drawBullets();
            drawInvaderBullets();
            drawInvaders();
            drawLives();
            moveSpaceship();
            invaderShootBullet();
            collisionDetection();
            requestAnimationFrame(draw);
        }

        let rightPressed = false;
        let leftPressed = false;

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') {
                rightPressed = true;
            } else if (e.key === 'ArrowLeft') {
                leftPressed = true;
            } else if (e.key === ' ') {
                shootBullet();
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowRight') {
                rightPressed = false;
            } else if (e.key === 'ArrowLeft') {
                leftPressed = false;
            }
        });

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth * 0.9;
            canvas.height = window.innerHeight * 0.6;
            invaderWidth = 7 * (canvas.width / 80); // Atualize o tamanho dos invasores
            invaderHeight = 7 * (canvas.width / 80); // Atualize o tamanho dos invasores
            invaderPadding = 1.5 * (canvas.width / 80); // Atualize o espaÃ§amento
            invaderOffsetTop = 20 * (canvas.width / 800); // Atualize o offset superior
            invaderOffsetLeft = (canvas.width - (invaderCols * (invaderWidth + invaderPadding))) / 2;
        });

        function startGame() {
            createInvaders();
            setInterval(resetInvaderShooting, 2000);
            draw();
        }

        window.addEventListener('load', () => {
            startGame();
        });

        function adjustCanvasSize() {
            canvas.width = window.innerWidth * 0.9;
            canvas.height = window.innerHeight * 0.6;
        }

        function handleTouchMove(event) {
            const touchX = event.touches[0].clientX;
            if (spaceshipTouchStartX) {
                const moveX = touchX - spaceshipTouchStartX;
                if (moveX > 0 && spaceship.x < canvas.width - spaceship.width) {
                    spaceship.x += spaceship.dx;
                } else if (moveX < 0 && spaceship.x > 0) {
                    spaceship.x -= spaceship.dx;
                }
            }
            spaceshipTouchStartX = touchX;
        }

        function clearTouchStart() {
            spaceshipTouchStartX = null;
        }

        playButton.addEventListener('click', startGame);
        playButton.addEventListener('touchstart', startGame);

        canvas.addEventListener('touchmove', handleTouchMove);
        canvas.addEventListener('touchend', clearTouchStart);

        window.addEventListener('load', adjustCanvasSize);
        window.addEventListener('resize', adjustCanvasSize);
    </script>
</body>
</html>
